######
#This is a autogenerated snakemake file by wBuild
#wBuild by Leonhard Wachutka
######

rule Scripts_Candidates_R:
    input: res_signif_all = config["PROC_RESULTS"] + "/mae/MAE_results.Rds", res_signif_rare = config["PROC_RESULTS"] + "/mae/MAE_results_rare.Rds", RScript = 'Scripts/Candidates.R'
    output: wBhtml = 'Output/html/Scripts_Candidates.html'
    script: '.wBuild/wBRender.R'


rule Scripts_Cascade_plot_R:
    input: maes = expand(config["PROC_DATA"] + "/mae/{id}.Rds", id = config["mae_ids"]), mae_res = config["PROC_RESULTS"] + "/mae/MAE_results.Rds", RScript = 'Scripts/Cascade_plot.R'
    output: wBhtml = 'Output/html/Scripts_Cascade_plot.html'
    threads: 40
    script: '.wBuild/wBRender.R'


rule Scripts_Results_MAE_R:
    input: mae_res = expand(config["PROC_RESULTS"] + "/mae/samples/{id}_res.Rds", id = config["mae_ids"]), RScript = 'Scripts/Results_MAE.R'
    output: res_signif_all = config["PROC_RESULTS"] + "/mae/MAE_results.Rds", res_signif_rare = config["PROC_RESULTS"] + "/mae/MAE_results_rare.Rds", wBhtml = 'Output/html/Scripts_Results_MAE.html'
    script: '.wBuild/wBRender.R'


rule Scripts_create_allelic_counts_R:
    input: vcf = standardFileNames("Data/helmholtz/{vcf}/exomicout/paired-endout/stdFilenames/{vcf}.vcf.gz"), rna = standardFileNames("Data/helmholtz/{rna}/RNAout/paired-endout/stdFilenames/{rna}.bam"), RScript = 'Scripts/create_allelic_counts.R'
    output: mae = config["PROC_DATA"] + "/mae/{vcf}-{rna}.Rds"
    threads: 1
    script: 'Scripts/create_allelic_counts.R'


rule Scripts_deseq_mae_R:
    input: mae_counts = config["PROC_DATA"] + "/mae/{vcf}-{rna}.Rds", vcf_uniqs = variantsPipeline(config["RAW_DATA"] + "/{vcf}/exomicout/paired-endout/processedData/vep_anno_{vcf}_uniq_dt.Rds"), RScript = 'Scripts/deseq_mae.R'
    output: mae_res = config["PROC_RESULTS"] + "/mae/samples/{vcf}-{rna}_res.Rds"
    script: 'Scripts/deseq_mae.R'


rule Index:
    input: 
        "Output/html/Scripts_Candidates.html",
        "Output/html/Scripts_Cascade_plot.html",
        "Output/html/Scripts_Results_MAE.html"
    output: "Output/html/index.html"
    run:
        import wbuild.createIndex
        wbuild.createIndex.ci()

